generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Usuario {
  id                 Int              @id @default(autoincrement())
  nome               String
  email              String           @unique
  senha              String
  jogosAdquiridos    UsuarioJogo[]
  consolesAdquiridos UsuarioConsole[]
  avaliacoes         Avaliacao[]

  @@map("usuarios")
}

model Jogo {
  id              Int   @id   @default(autoincrement())
  nome            String
  desenvolvedor   String
  genero          String
  anoLancamento   Int
  preco           Decimal @db.Decimal(10, 2)
  descricao       String
  imagens         String[] @default([])
  crestedAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt

  consolesRelacionados JogoConsole[]
  avaliacoes           Avaliacao[]
  usuariosQuePossuem   UsuarioJogo[]

  @@map("jogos")
}

model Console {
  id            Int      @id @default(autoincrement())
  nome          String
  nota          Decimal  @db.Decimal(10, 2)
  anoLancamento Int
  preco         Decimal  @db.Decimal(10, 2)
  descricao     String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  jogosRelacionados  JogoConsole[]
  avaliacoes         Avaliacao[]
  usuariosQuePossuem UsuarioConsole[]

  @@map("consoles")
}

model Avaliacao {
  id         Int     @id @default(autoincrement())
  comentario String
  nota       Decimal @db.Decimal(10, 2)

  jogoId    Int?
  consoleId Int?
  usuarioId Int

  jogo    Jogo?    @relation(fields: [jogoId], references: [id])
  console Console? @relation(fields: [consoleId], references: [id])
  usuario Usuario  @relation(fields: [usuarioId], references: [id])

  @@map("avaliacoes")
}

model JogoConsole {
  jogoId    Int
  consoleId Int

  jogo    Jogo    @relation(fields: [jogoId], references: [id])
  console Console @relation(fields: [consoleId], references: [id])

  @@id([jogoId, consoleId])
  @@map("jogo_console")
}

model UsuarioJogo {
  usuarioId Int
  jogoId    Int

  usuario Usuario @relation(fields: [usuarioId], references: [id])
  jogo    Jogo    @relation(fields: [jogoId], references: [id])

  @@id([usuarioId, jogoId])
  @@map("usuario_jogo")
}

model UsuarioConsole {
  usuarioId Int
  consoleId Int

  usuario Usuario @relation(fields: [usuarioId], references: [id])
  console Console @relation(fields: [consoleId], references: [id])

  @@id([usuarioId, consoleId])
  @@map("usuario_console")
}
